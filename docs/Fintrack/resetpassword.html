<!DOCTYPE html>
<html lang="en" style="scroll-behavior: smooth;">

<head>
    <script src="bot.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinTrack - Reset Password</title>
    <link rel="stylesheet" href="vvvg.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="hamburgr.css">
    <link rel="stylesheet" href="dash.css">
</head>

<body style="background-color: white;">
    <nav class="nav">
        <div class="hamburger-menu">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </div>

        <div class="sidebar-overlay"></div>

        <div class="sidebar">
            <div class="sidebar-header">
                <a href="profile.html" class="profile-link">
                    <img src="pngtree-avatar-icon-profile-icon-member-login-vector-isolated-png-image_5247852.jpg"
                        alt="Profile" class="profile-icon">
                </a>
                <div class="close-btn">&times;</div>
            </div>
            <div class="sidebar-content">
                <a href="index.html">Home</a>
                <a href="dashboard.html">Dashboard</a>
                <a href="learn-more-html.html">Learn More</a>
                <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
                <a href="customer_support.html">Contact Us</a>
                <a href="#" id="logout-btn" style="display: none;" class="nav-link" onclick="logout()">Log Out</a>
            </div>
        </div>

        <script src="hmg.js"></script>

        <div class="logo">FinTrack</div>
        <div class="nav-links">
            <a href="index.html" class="nav-link">Home</a>
            <a href="dashboard.html" class="nav-link">Dashboard</a>
            <a href="signin.html" id="auth-link" style="display: none;" class="nav-link">Sign In</a>
        </div>
    </nav>

    <script src="auth.js"></script>

    <style>
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, #2c5ce0, #ff5733);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .reset-password-container {
            max-width: 500px;
            margin: 50px auto;
            padding: 30px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .reset-password-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        .reset-password-form input {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .reset-password-form input:focus {
            border-color: #2c5ce0;
            outline: none;
            box-shadow: 0 0 0 2px rgba(44, 92, 224, 0.2);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            display: inline-block;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(to right, #2c5ce0, #4a80e4);
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(44, 92, 224, 0.3);
        }

        .message {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        .error-message {
            background-color: #ffeded;
            border: 1px solid #ff453a;
            color: #ff453a;
        }

        .success-message {
            background-color: #e8f5e9;
            border: 1px solid #32d74b;
            color: #32d74b;
        }

        .text-center {
            text-align: center;
        }

        .text-link {
            color: #2c5ce0;
            text-decoration: none;
            font-weight: 500;
        }

        .text-link:hover {
            text-decoration: underline;
        }

        .help-text {
            font-size: 14px;
            color: #86868b;
            margin-top: -15px;
            margin-bottom: 20px;
        }
    </style>

    <div class="reset-password-container">
        <h1 class="text-center">Reset Password</h1>
        <p class="text-center" style="color: #86868b; margin-bottom: 30px;">Create a new password for your account</p>

        <form id="reset-password-form" class="reset-password-form">
            <input type="hidden" id="token" name="token">
            
            <label for="new-password">New Password</label>
            <input type="password" id="new-password" name="new-password" placeholder="••••••••" required minlength="8">
            <p class="help-text">Password must be at least 8 characters</p>

            <label for="confirm-password">Confirm New Password</label>
            <input type="password" id="confirm-password" name="confirm-password" placeholder="••••••••" required minlength="8">

            <div id="password-match-error" class="message error-message">
                <p>Passwords do not match. Please try again.</p>
            </div>

            <div id="reset-success" class="message success-message">
                <p>Password has been reset successfully!</p>
            </div>

            <div id="reset-error" class="message error-message">
                <p>There was an error resetting your password. The link may have expired.</p>
            </div>

            <button type="submit" class="btn btn-primary">Set New Password</button>

            <div class="text-center" style="margin-top: 20px; color: #86868b;">
                Remember your password? <a href="signin.html" class="text-link">Sign in</a>
            </div>
            <div class="text-center" style="margin-top: 10px; color: #86868b;">
                Having trouble? <a href="customer_support.html" class="text-link">Contact Support</a>
            </div>
        </form>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-column">
                <h4>Product</h4>
                <ul>
                    <li><a href="#">Features</a></li>
                    <li><a href="#">Pricing</a></li>
                    <li><a href="#">Mobile App</a></li>
                    <li><a href="#">Browser Extension</a></li>
                    <li><a href="#">Roadmap</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h4>Company</h4>
                <ul>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Careers</a></li>
                    <li><a href="#">Press Kit</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h4>Resources</h4>
                <ul>
                    <li><a href="#">Help Center</a></li>
                    <li><a href="#">Community</a></li>
                    <li><a href="#">Financial Guides</a></li>
                    <li><a href="#">API Documentation</a></li>
                    <li><a href="#">Security</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h4>Connect With Us</h4>
                <p>Subscribe to our newsletter for tips, updates, and financial wisdom.</p>
                <div class="social-icons">
                    <a href="#" class="social-icon">X</a>
                    <a href="#" class="social-icon">F</a>
                    <a href="#" class="social-icon">I</a>
                    <a href="#" class="social-icon">L</a>
                </div>
            </div>
        </div>

        <div class="footer-bottom">
            <p>© 2025 FinTrack. All rights reserved.</p>
            <p style="margin-top: 8px;">
                <a href="#" style="margin-right: 16px;">Privacy Policy</a>
                <a href="#" style="margin-right: 16px;">Terms of Service</a>
                <a href="#">Cookie Settings</a>
            </p>
        </div>
    </footer>

    <script>
        // Form submission
        document.getElementById("reset-password-form").addEventListener("submit", async function(event) {
            event.preventDefault();
            
            const newPassword = document.getElementById("new-password").value;
            const confirmPassword = document.getElementById("confirm-password").value;
            // Hide any previous messages
            document.getElementById("password-match-error").style.display = "none";
            document.getElementById("reset-success").style.display = "none";
            document.getElementById("reset-error").style.display = "none";
            
            // Check if passwords match
            if (newPassword !== confirmPassword) {
                document.getElementById("password-match-error").style.display = "block";
                return;
            }
            const email = localStorage.getItem("userEmail");
            const urlParams = new URLSearchParams(window.location.search);
            const token = urlParams.get('resetToken');
            console.log(token);
            if(!token){
                alert("Unauthorized access.");
                return;
            }
            // Send request to API
            fetch("https://my-backend-api-erp6.onrender.com/api/reset-password", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ 
                    email:email,
                    resetToken: token,
                    newPassword: newPassword
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById("reset-success").style.display = "block";
                    // Redirect to login page after 2 seconds
                    localStorage.removeItem("resetToken");
                    localStorage.removeItem("userEmail");
                    setTimeout(() => {
                        window.location.href = "signin.html";
                    }, 2000);
                } else {
                    document.getElementById("reset-error").style.display = "block";
                }
            })
            .catch(error => {
                console.error("Error:", error);
                document.getElementById("reset-error").style.display = "block";
            });
        });
    </script>
</body>

</html>
